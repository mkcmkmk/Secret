<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Valentine Calendar üíù</title>
  <style>
    :root{
      --bg:#fff1f5;
      --card:#ffffffcc;
      --text:#111827;
      --muted:#6b7280;
      --pink:#fb7185;
      --pink2:#f43f5e;
      --line:#fbcfe8;
      --locked:#9ca3af;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      min-height:100vh;
      background:
        radial-gradient(900px 500px at 15% 10%, #ffe4e6, transparent),
        radial-gradient(900px 500px at 85% 90%, #ffd1dc, transparent),
        var(--bg);
      color:var(--text);
      display:flex;
      justify-content:center;
      padding:18px;
    }
    .wrap{width:min(980px, 100%)}
    header{
      background:var(--card);
      border:1px solid #fff;
      backdrop-filter: blur(10px);
      border-radius:22px;
      padding:18px;
      box-shadow: 0 18px 50px rgba(0,0,0,.08);
    }
    h1{margin:0;font-size:22px}
    .sub{margin-top:6px;color:var(--muted);line-height:1.5}
    .meta{
      margin-top:12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid #fff;
      background:#fff;
      font-size:13px;
      color:var(--muted);
    }
    .pill b{color:var(--text)}
    .right{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;}
    .grid{
      margin-top:14px;
      display:grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap:12px;
    }
    @media (max-width:820px){ .grid{grid-template-columns: repeat(2, minmax(0,1fr));} }

    .day{
      background:var(--card);
      border:1px solid #fff;
      backdrop-filter: blur(10px);
      border-radius:20px;
      padding:14px;
      box-shadow: 0 12px 34px rgba(0,0,0,.07);
      position:relative;
      overflow:hidden;
      min-height:155px;
    }
    .day::before{
      content:"";
      position:absolute;
      inset:-2px;
      background: radial-gradient(500px 220px at 20% 20%, rgba(244,63,94,.18), transparent);
      pointer-events:none;
    }
    .top{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      position:relative;
      z-index:1;
    }
    .date{display:flex;flex-direction:column;gap:4px}
    .date .d{font-weight:800;font-size:16px}
    .date .m{color:var(--muted);font-size:12px}
    .tag{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      color:var(--muted);
      white-space:nowrap;
    }
    .giftIcon{
      font-size:38px;
      margin-top:14px;
      position:relative;
      z-index:1;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.10));
    }
    .btnRow{
      margin-top:12px;
      display:flex;
      gap:10px;
      position:relative;
      z-index:1;
    }
    button{
      border:none;
      border-radius:14px;
      padding:10px 12px;
      font-weight:800;
      cursor:pointer;
      transition: transform .08s ease, opacity .2s ease;
      user-select:none;
      width:100%;
    }
    button:active{transform:scale(.98)}
    .openBtn{
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:#fff;
      box-shadow: 0 10px 22px rgba(244,63,94,.25);
    }
    .disabled{
      background:#fff;
      border:1px solid #e5e7eb;
      color:var(--locked);
      cursor:not-allowed;
      opacity:.75;
    }
    .status{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
      position:relative;
      z-index:1;
    }
    .linkBtn{
      background:#fff;
      border:1px solid var(--line);
      color:var(--text);
      font-weight:800;
      width:auto;
      padding:10px 14px;
    }

    /* === Modal === */
    .backdrop{
      position:fixed; inset:0;
      background: rgba(17,24,39,.45);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:50;
    }
    .modal{
      width:min(560px,100%);
      background:#fff;
      border-radius:22px;
      padding:18px;
      box-shadow: 0 30px 90px rgba(0,0,0,.25);
      border:1px solid #f3f4f6;
      position:relative;
      overflow:hidden;
    }
    .modal h2{margin:0 0 6px;font-size:20px}
    .modal p{margin:0;color:var(--muted);line-height:1.6}
    .note{
      margin-top:10px;
      background:#fff7ed;
      border:1px solid #fed7aa;
      color:#9a3412;
      padding:10px 12px;
      border-radius:14px;
      font-size:13px;
      display:none;
    }
    .modalBtns{margin-top:12px;display:flex;gap:10px}
    .closeBtn{background:#111827;color:#fff}

    /* === Tap hint === */
    .tapHint{
      position:absolute;
      bottom:12px;
      left:50%;
      transform: translateX(-50%);
      background: rgba(255,255,255,.92);
      border:1px solid #fbcfe8;
      padding:8px 12px;
      border-radius:999px;
      font-size:13px;
      color:#6b7280;
      display:none;
      gap:8px;
      align-items:center;
      box-shadow: 0 10px 28px rgba(0,0,0,.08);
      user-select:none;
      pointer-events:none;
    }
    .tapHint.show{display:inline-flex}
    .tapPulse{
      width:10px;height:10px;border-radius:50%;
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      box-shadow: 0 0 0 0 rgba(244,63,94,.35);
      animation: pulse 1.1s infinite;
    }
    @keyframes pulse{
      0%{ box-shadow:0 0 0 0 rgba(244,63,94,.35); }
      100%{ box-shadow:0 0 0 12px rgba(244,63,94,0); }
    }

    /* === Cute Gift Animation === */
    .giftStage{
      margin:14px 0 8px;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      min-height:185px;
    }

    .giftBox{
      width:140px;
      height:120px;
      position:relative;
      transform-origin: center;
      filter: drop-shadow(0 16px 18px rgba(0,0,0,.18));
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    .giftBox:active{ transform: scale(.98); }

    .giftBox .base{
      position:absolute;
      left:0; right:0;
      bottom:0;
      height:86px;
      background: linear-gradient(135deg, #fb7185, #f43f5e);
      border-radius:18px;
      border:1px solid rgba(255,255,255,.7);
    }
    .giftBox .lid{
      position:absolute;
      left:-6px; right:-6px;
      top:18px;
      height:44px;
      background: linear-gradient(135deg, #ff9fb2, #fb7185);
      border-radius:18px;
      border:1px solid rgba(255,255,255,.8);
      transform-origin: 20% 90%;
      transform: translateY(0) rotate(0deg);
    }
    .giftBox .ribbonV{
      position:absolute;
      top:18px;
      left:50%;
      transform:translateX(-50%);
      width:18px;
      height:88px;
      background: rgba(255,255,255,.75);
      border-radius:12px;
      mix-blend-mode: soft-light;
    }
    .giftBox .ribbonH{
      position:absolute;
      bottom:38px;
      left:10px; right:10px;
      height:16px;
      background: rgba(255,255,255,.70);
      border-radius:12px;
      mix-blend-mode: soft-light;
    }
    .giftBox .bow{
      position:absolute;
      top:0;
      left:50%;
      transform: translateX(-50%);
      width:70px;
      height:40px;
    }
    .giftBox .bow:before,
    .giftBox .bow:after{
      content:"";
      position:absolute;
      top:8px;
      width:32px;
      height:22px;
      border-radius: 16px 16px 16px 0;
      background: rgba(255,255,255,.82);
      transform: rotate(12deg);
    }
    .giftBox .bow:after{
      right:0;
      border-radius: 16px 16px 0 16px;
      transform: rotate(-12deg);
    }
    .giftBox .knot{
      position:absolute;
      top:14px;
      left:50%;
      transform: translateX(-50%);
      width:14px;
      height:14px;
      border-radius:50%;
      background: rgba(255,255,255,.92);
    }

    .revealEmoji{
      position:absolute;
      font-size:54px;
      opacity:0;
      transform: translateY(18px) scale(.85);
      transition: opacity .35s ease, transform .35s ease;
      filter: drop-shadow(0 12px 14px rgba(0,0,0,.18));
      pointer-events:none;
    }

    .sparkle{
      position:absolute;
      font-size:18px;
      opacity:0;
      transform: scale(.6);
      pointer-events:none;
    }

    /* Opening state */
    .opening .giftBox{ animation: boxBounce .55s ease; }
    .opening .giftBox .lid{ animation: lidPop .65s cubic-bezier(.2,.9,.2,1) forwards; }
    .opening .revealEmoji{
      opacity:1;
      transform: translateY(-42px) scale(1);
      transition-delay: .35s;
    }
    .opening .sparkle{ animation: sparklePop 800ms ease forwards; }

    @keyframes lidPop{
      0%   { transform: translateY(0) rotate(0deg); }
      55%  { transform: translateY(-34px) rotate(-18deg); }
      100% { transform: translateY(-36px) rotate(-22deg); }
    }
    @keyframes boxBounce{
      0%{ transform: translateY(0) scale(1); }
      45%{ transform: translateY(6px) scale(.98); }
      100%{ transform: translateY(0) scale(1); }
    }
    @keyframes sparklePop{
      0%{ opacity:0; transform: translate(0,0) scale(.4); }
      35%{ opacity:1; }
      100%{ opacity:0; transform: translate(var(--dx), var(--dy)) scale(1.2); }
    }

    /* Floating hearts */
    .heart{
      position:fixed;
      bottom:-20px;
      font-size:18px;
      animation: floatUp linear forwards;
      opacity:.9;
      pointer-events:none;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.12));
      z-index:60;
    }
    @keyframes floatUp{
      to{
        transform: translateY(-110vh) translateX(var(--drift));
        opacity:0;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>üíù Valentine Gift Calendar</h1>
      <div class="sub">
        One gift per day, only from <b>Feb 7</b> to <b>Feb 14</b>.
        Open <b>today‚Äôs</b> gift once, then it locks üòÑ
      </div>

      <div class="meta">
        <div class="pill">üìÖ Today: <b id="todayText">‚Äî</b></div>
        <div class="right">
          <button class="linkBtn" id="shareBtn" type="button">Share this page üîó</button>
          <button class="linkBtn" id="resetBtn" type="button" title="For testing only">Reset opens (test) üß™</button>
        </div>
      </div>
    </header>

    <section class="grid" id="grid"></section>
  </div>

  <!-- Modal -->
  <div class="backdrop" id="backdrop">
    <div class="modal">
      <h2 id="modalTitle">Gift</h2>

      <div class="giftStage" id="giftStage">
        <div class="giftBox" id="giftBox" role="button" aria-label="Tap to open gift">
          <div class="bow"></div>
          <div class="knot"></div>
          <div class="lid"></div>
          <div class="base"></div>
          <div class="ribbonV"></div>
          <div class="ribbonH"></div>
        </div>

        <div class="revealEmoji" id="revealEmoji">üéÅ</div>

        <div class="sparkle" id="sp1">‚ú®</div>
        <div class="sparkle" id="sp2">üíñ</div>
        <div class="sparkle" id="sp3">‚ú®</div>
        <div class="sparkle" id="sp4">üíï</div>
        <div class="sparkle" id="sp5">‚ú®</div>

        <div class="tapHint" id="tapHint">
          <span class="tapPulse"></span>
          Tap the gift to open üéÅ
        </div>
      </div>

      <p id="modalText">‚Äî</p>
      <div class="note" id="modalNote"></div>

      <div class="modalBtns">
        <button class="closeBtn" id="closeBtn" type="button">Close</button>
      </div>
    </div>
  </div>

<script>
  // ====== CONFIG ======
  const YEAR = 2026; // change to the year you will use
  const TEST_MODE = false; // ‚úÖ set true to test anytime, set false for real dates

  const START = { month: 1, day: 7 }; // Feb (0=Jan,1=Feb)
  const END   = { month: 1, day: 14 };

  const gifts = [
    { day: 7,  emoji: "üåπ", title: "Day 1 ‚Äì Rose Day", message: "A little flower for you. You deserve soft days and sweet smiles." },
    { day: 8,  emoji: "üíçüßé‚Äç‚ôÇÔ∏è", title: "Day 2 ‚Äì Propose Day", message: "open the box" },
    { day: 9,  emoji: "üç´", title: "Day 3 ‚Äì Chocolate Day", message: "Chocolate for you üòÑ (Pretend I just handed you your favorite.)" },
    { day: 10, emoji: "üß∏", title: "Day 4 ‚Äì Teddy Day", message: "A teddy hug. If you‚Äôre stressed, consider this a long one ü´Ç" },
    { day: 11, emoji: "ü´¥üèªü§û", title: "Day 5 ‚Äì Promise Day", message: "" },
    { day: 12, emoji: "ü´Çüíï", title: "Day 6 ‚Äì Hug Day", message: "A long hug for you to show that you're loved ü§ó" },
    { day: 13, emoji: "üòò", title: "Day 7 ‚Äì Kiss Day", message: "ummmmmwa ü´£üíò)" },
    { day: 14, emoji: "üíñ", title: "Day 8 ‚Äì Valentine‚Äôs Day", message: "Will you be my Valentine? üåπ (Say yes and I‚Äôll plan something nice.)" },
  ];

  // ====== ELEMENTS ======
  const grid = document.getElementById("grid");
  const todayText = document.getElementById("todayText");

  const backdrop = document.getElementById("backdrop");
  const modalTitle = document.getElementById("modalTitle");
  const modalText  = document.getElementById("modalText");
  const modalNote  = document.getElementById("modalNote");
  const closeBtn   = document.getElementById("closeBtn");

  const giftStage = document.getElementById("giftStage");
  const giftBox = document.getElementById("giftBox");
  const revealEmoji = document.getElementById("revealEmoji");
  const tapHint = document.getElementById("tapHint");

  const sparkles = [
    document.getElementById("sp1"),
    document.getElementById("sp2"),
    document.getElementById("sp3"),
    document.getElementById("sp4"),
    document.getElementById("sp5"),
  ];

  const shareBtn = document.getElementById("shareBtn");
  const resetBtn = document.getElementById("resetBtn");

  // ====== STATE ======
  let modalReadyToOpen = false; // controls tap-to-open
  let modalOpenedOnce = false;  // prevents re-opening animation spam
  let currentGiftDay = null; // ‚úÖ which gift is currently in the modal
  

  // ====== HELPERS ======
  const keyForDay = (yyyy, mm, dd) => `valGiftOpened:${yyyy}-${String(mm+1).padStart(2,"0")}-${String(dd).padStart(2,"0")}`;
  function dateObj(year, monthIndex, day){ return new Date(year, monthIndex, day, 0,0,0,0); }
  function isSameDay(a,b){ return a.getFullYear()===b.getFullYear() && a.getMonth()===b.getMonth() && a.getDate()===b.getDate(); }

  function popHearts(count=14){
    const hearts = ["üíñ","üíò","üíù","üíï","üå∏","‚ù§Ô∏è"];
    for(let i=0;i<count;i++){
      const h = document.createElement("div");
      h.className = "heart";
      h.textContent = hearts[Math.floor(Math.random()*hearts.length)];
      const left = Math.random()*100;
      const dur = 2.3 + Math.random()*2.7;
      const drift = (Math.random()*140 - 70) + "px";
      h.style.left = left + "vw";
      h.style.setProperty("--drift", drift);
      h.style.animationDuration = dur + "s";
      h.style.fontSize = (16 + Math.random()*20) + "px";
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), dur*1000);
    }
  }

  function randomizeSparkles(){
    const positions = [
      {x:-40, y:-10}, {x: 45, y:-20}, {x:-55, y: 30}, {x: 55, y: 25}, {x: 0, y:-55},
    ];
    sparkles.forEach((sp, i) => {
      const p = positions[i] || {x:0,y:0};
      const dx = (p.x + (Math.random()*20 - 10)) + "px";
      const dy = (p.y + (Math.random()*20 - 10)) + "px";
      sp.style.left = "50%";
      sp.style.top = "52%";
      sp.style.setProperty("--dx", dx);
      sp.style.setProperty("--dy", dy);
      sp.style.animationDelay = (i * 70) + "ms";
    });
  }

  // ====== SOUND (Web Audio) ======
  let audioCtx = null;

  function ensureAudio(){
    if(!audioCtx){
      const AC = window.AudioContext || window.webkitAudioContext;
      audioCtx = AC ? new AC() : null;
    }
    // Some browsers start suspended until user gesture
    if(audioCtx && audioCtx.state === "suspended"){
      audioCtx.resume().catch(()=>{});
    }
  }

  function playPop(){
    if(!audioCtx) return;
    const t = audioCtx.currentTime;

    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();

    osc.type = "sine";
    osc.frequency.setValueAtTime(320, t);
    osc.frequency.exponentialRampToValueAtTime(120, t + 0.08);

    gain.gain.setValueAtTime(0.0001, t);
    gain.gain.exponentialRampToValueAtTime(0.25, t + 0.01);
    gain.gain.exponentialRampToValueAtTime(0.0001, t + 0.10);

    osc.connect(gain);
    gain.connect(audioCtx.destination);

    osc.start(t);
    osc.stop(t + 0.11);
  }

  function playSparkle(){
    if(!audioCtx) return;
    const t = audioCtx.currentTime;

    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    const filter = audioCtx.createBiquadFilter();

    osc.type = "triangle";
    filter.type = "highpass";
    filter.frequency.setValueAtTime(900, t);

    // little rising twinkle
    osc.frequency.setValueAtTime(700, t);
    osc.frequency.exponentialRampToValueAtTime(1400, t + 0.12);

    gain.gain.setValueAtTime(0.0001, t);
    gain.gain.exponentialRampToValueAtTime(0.18, t + 0.02);
    gain.gain.exponentialRampToValueAtTime(0.0001, t + 0.18);

    osc.connect(filter);
    filter.connect(gain);
    gain.connect(audioCtx.destination);

    osc.start(t);
    osc.stop(t + 0.19);
  }
  function closeModal(){
  backdrop.style.display = "none";

  // ‚úÖ fully reset animation + state
  giftStage.classList.remove("opening");
  tapHint.classList.remove("show");

  modalReadyToOpen = false;
  modalOpenedOnce = false;
  currentGiftDay = null;
}

  // ====== MODAL FLOW ======
function showModal(gift, noteText=null, showTapToOpen=true){
  currentGiftDay = gift.day; // ‚úÖ remember which day is opened in modal

  modalTitle.textContent = gift.title;
  modalText.textContent = gift.message;
  revealEmoji.textContent = gift.emoji;

  if(noteText){
    modalNote.style.display = "block";
    modalNote.textContent = noteText;
  } else {
    modalNote.style.display = "none";
    modalNote.textContent = "";
  }

  // reset animation state
  giftStage.classList.remove("opening");
  void giftStage.offsetWidth;

  randomizeSparkles();

  modalReadyToOpen = !!showTapToOpen;
  modalOpenedOnce = false;

  tapHint.classList.toggle("show", showTapToOpen);

  backdrop.style.display = "flex";
}



function runOpenAnimation(){
  // Debug (optional) ‚Äî keep for now to verify
  console.log("gift tapped ‚úÖ", { modalReadyToOpen, modalOpenedOnce, currentGiftDay });

  if(!modalReadyToOpen || modalOpenedOnce) return;

  modalOpenedOnce = true;
  modalReadyToOpen = false;
  tapHint.classList.remove("show");

  ensureAudio();
  playPop();

  giftStage.classList.remove("opening");
  void giftStage.offsetWidth;
  giftStage.classList.add("opening");

  setTimeout(() => playSparkle(), 120);
  setTimeout(() => popHearts(18), 90);

  // ‚úÖ Redirect ONLY after gift is tapped/opened
  if (currentGiftDay === 8) {
    setTimeout(() => {
      window.location.href = "propose.html";
    }, 900);
  }

  if (currentGiftDay === 14) {
    setTimeout(() => {
      window.location.href = "letter.html";
    }, 900);
  }
}
// ‚úÖ Close button + backdrop close
closeBtn.addEventListener("click", (e) => {
  e.stopPropagation();
  closeModal();
});

backdrop.addEventListener("click", (e) => {
  if (e.target === backdrop) closeModal();
});

// ‚úÖ Prevent clicks inside the modal from closing it
document.querySelector(".modal").addEventListener("click", (e) => {
  e.stopPropagation();
});

// ‚úÖ Gift tap handler (set ONCE, not inside render)
giftBox.onclick = () => runOpenAnimation();




  // ====== MAIN LOGIC ======
  const startDate = dateObj(YEAR, START.month, START.day);
  const endDate   = dateObj(YEAR, END.month, END.day);

  const now = new Date();
  const todayMid = dateObj(now.getFullYear(), now.getMonth(), now.getDate());
  todayText.textContent = now.toLocaleDateString(undefined, { weekday:"long", year:"numeric", month:"short", day:"numeric" });

  function render(){
    grid.innerHTML = "";

    for(const g of gifts){
      const d = dateObj(YEAR, 1, g.day); // Feb = 1
      const openedKey = keyForDay(d.getFullYear(), d.getMonth(), d.getDate());
      const alreadyOpened = localStorage.getItem(openedKey) === "true";

      const isBeforeStart = todayMid < startDate;
      const isAfterEnd = todayMid > endDate;

      const isToday = isSameDay(d, todayMid);
      const isPast = d < todayMid;
      const isFuture = d > todayMid;

      let tag = "üîí Locked";
      if (isToday) tag = alreadyOpened ? "‚úÖ Opened today" : "üéÅ Available today";
      if (isPast) tag = alreadyOpened ? "‚úÖ Opened" : "‚è≥ Missed (locked)";
      if (isFuture) tag = "üîí Not yet";

    //   const canOpenToday = isToday && !alreadyOpened && !isBeforeStart && !isAfterEnd;
    const canOpenToday = TEST_MODE
  ? !alreadyOpened
  : (isToday && !alreadyOpened && !isBeforeStart && !isAfterEnd);


      const card = document.createElement("div");
      card.className = "day";
      card.innerHTML = `
        <div class="top">
          <div class="date">
            <div class="d">Feb ${g.day}</div>
            <div class="m">${YEAR}</div>
          </div>
          <div class="tag">${tag}</div>
        </div>

        <div class="giftIcon">${g.emoji}</div>

        <div class="btnRow">
          <button class="${canOpenToday ? "openBtn" : "disabled"}" ${canOpenToday ? "" : "disabled"}>
            ${canOpenToday ? "Open gift üéÅ" : "Can't open"}
          </button>
        </div>

        <div class="status">
          ${isBeforeStart ? "Calendar starts Feb 7." :
            isAfterEnd ? "Calendar ended on Feb 14." :
            isToday ? (alreadyOpened ? "You already opened this today üòÑ" : "Open it! üëÄ") :
            isFuture ? "Come back on that day üíó" :
            "This day is over ‚Äî it stays locked."}
        </div>
      `;

      const btn = card.querySelector("button");

      // open (only today, only once)
btn.addEventListener("click", () => {
  if (!canOpenToday) return;

  localStorage.setItem(openedKey, "true");
  currentGiftDay = g.day;

  showModal(g, "Now tap the gift to reveal it üòÑ", true);
  render();
});


     


      // Replay already opened gift: double click (no tap-to-open)
      card.addEventListener("dblclick", () => {
        if(alreadyOpened){
          showModal(g, "Replay mode ‚úÖ (Tap gift if you want the animation again)", true);
        }
      });

      grid.appendChild(card);
    }
  }

  render();

  // Share
  document.getElementById("shareBtn").addEventListener("click", async () => {
    const url = location.href;
    try{
      if(navigator.share){
        await navigator.share({ title: document.title, url });
      } else {
        await navigator.clipboard.writeText(url);
        alert("Link copied ‚úÖ");
      }
    }catch(e){}
  });
  

  // Reset (testing)
  document.getElementById("resetBtn").addEventListener("click", () => {
    const ok = confirm("Reset all opened gifts on this device? (Testing only)");
    if(!ok) return;
    for(const g of gifts){
      const d = dateObj(YEAR, 1, g.day);
      localStorage.removeItem(keyForDay(d.getFullYear(), d.getMonth(), d.getDate()));
    }
    render();
  });

  // Pre-warm audio on first user interaction anywhere (helps mobile)
  window.addEventListener("pointerdown", () => {
    ensureAudio();
  }, { once:true });
</script>
</body>
</html>
